(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[234],{6528:function(t,n,e){"use strict";e.d(n,{Z:function(){return W}});var i=e(2777),o=e(2262),r=e(748),l=e(5959),a=e(3553),s=e(7247),c=e(9499),h=e(7294),u=e(1664),d=e(9239),f=e.n(d),m=e(238),v=e(9661),g=e(9629),p=e(8280),y=e.n(p),L=e(6687),w={mode:"position",el:"#waterfall",columnWidth:360,columnCount:void 0,columnGap:24,rowGap:24,delay:500,customStyle:"",onChangeUlMaxH:function(t){return t}};function Z(t){var n=(0,L.Z)(t).map((function(t){return new Promise((function(n,e){t.onload=function(){n("image unloded")},t.onerror=function(){e("image unloded error")},t.complete&&n("image has loded")}))}));return Promise.allSettled(n).then((function(t){return t})).catch((function(t){return console.log(t)}))}var x=function(){function t(n){(0,i.Z)(this,t),(0,c.Z)(this,"config",void 0),(0,c.Z)(this,"container",void 0),(0,c.Z)(this,"containerWidth",void 0),(0,c.Z)(this,"columnCount",void 0),(0,c.Z)(this,"liLeft",void 0),(0,c.Z)(this,"liNodes",void 0),(0,c.Z)(this,"itemList",void 0),(0,c.Z)(this,"colList",void 0),(0,c.Z)(this,"handleTimer",void 0),(0,c.Z)(this,"ulMaxH",void 0),(0,c.Z)(this,"prevImageLength",void 0),(0,c.Z)(this,"prevLiNodesLength",void 0),(0,c.Z)(this,"lastItemsBottom",void 0),this.config=n,this.container=document.querySelector(n.el),this.containerWidth=0,this.columnCount=n.columnCount||0,this.liLeft=0,this.liNodes=[],this.itemList=[],this.colList=[],this.handleTimer=null,this.ulMaxH=0,this.prevImageLength=0,this.prevLiNodesLength=0,this.lastItemsBottom=[0,0],this.init()}return(0,o.Z)(t,[{key:"init",value:function(){if(!this.container)throw"container element id:".concat(this.config.el," is not exist");var t=this.config,n=t.el,e=t.columnWidth,i=t.customStyle;this.containerWidth=this.container.offsetWidth,this.columnCount=this.columnCount||parseInt(this.containerWidth/e+""),function(t,n,e){var i=document.createElement("style"),o="\n      ".concat(t," {\n        position: relative;\n      }\n      ").concat(t,">li {\n          position: absolute;\n          width: ").concat(n,"px;\n          left: 0;\n          top: 0;\n          list-style: none;\n      }\n      ").concat(t,">li.show {\n        transform: translateY(0);\n        transition: all 0.3s;\n      }\n      ").concat(e,"\n  ");i.innerHTML=o,document.head.appendChild(i)}(n,e,i)}},{key:"load",value:function(){var t=this.container.querySelectorAll("li");if((null===t||void 0===t?void 0:t.length)<=0)throw"container element id:".concat(this.config.el,">li is not exist");var n=this.prevLiNodesLength-t.length;this.liNodes=Array.from(t).slice(n),this.prevLiNodesLength=t.length,this.lastItemsBottom=this.colList.map((function(t){var n;return null===(n=t[t.length-1])||void 0===n?void 0:n.bottom})),this.initLayout(),this.initPolling()}},{key:"initLayout",value:function(){this.itemList=[],this.colList=[];for(var t=0;t<this.columnCount;t++)this.colList.push([]);for(var n=0;n<this.liNodes.length;n++){var e=this.liNodes[n].offsetHeight+this.config.rowGap;this.itemList.push({index:n,bottom:e,height:e})}this.refreshLayout()}},{key:"refreshLayout",value:function(){for(var t=this.itemList,n=this.colList,e=0;e<this.liNodes.length;e++){for(var i=t[e].height,o=0,r=0,l=0;l<n.length;l++){var a,s,c=n[l].length-1,h=((null===(a=n[l])||void 0===a||null===(s=a[c])||void 0===s?void 0:s.bottom)||this.lastItemsBottom[l]||0)+i;(0==o||h<o)&&(o=h,r=l)}t[e].bottom=o,n[r].push(t[e])}this.renderView()}},{key:"renderView",value:function(){for(var t=this.colList,n=0;n<t.length;n++)for(var e=t[n],i=0;i<e.length;i++){var o=this.liNodes[e[i].index],r=0===n?0:this.config.columnGap*n;o.style.left=n*this.config.columnWidth+this.liLeft+r+"px",o.style.top=e[i].bottom-e[i].height+"px"}for(var l=0;l<this.liNodes.length;l++)this.liNodes[l].classList.contains("show")||this.liNodes[l].classList.add("show");for(var a=0;a<t.length;a++){var s=t[a].length-1,c=t[a][s]?t[a][s].bottom:0;this.ulMaxH<c&&(this.ulMaxH=c)}this.container.style.height=this.ulMaxH+"px"}},{key:"loadImages",value:function(){var t,n=(null===(t=this.container)||void 0===t?void 0:t.querySelectorAll("img"))||[],e=this.prevImageLength-n.length,i=(0,L.Z)(n).slice(e);return this.prevImageLength=n.length,Z(i)}},{key:"initPolling",value:function(){var t=this;this.pollingRefresh(),this.loadImages().then((function(){t.handleTimer&&clearInterval(t.handleTimer),t.initLayout(),setTimeout((function(){var n,e;null===(n=t.config)||void 0===n||null===(e=n.onChangeUlMaxH)||void 0===e||e.call(n,t.ulMaxH)}),20)})).catch((function(n){console.log("\u56fe\u7247\u52a0\u8f7d\u4efb\u52a1\u51fa\u9519--\x3e",n),t.handleTimer&&clearInterval(t.handleTimer)}))}},{key:"pollingRefresh",value:function(){var t=this;this.handleTimer&&clearInterval(this.handleTimer),this.handleTimer=setInterval((function(){t.initLayout(),console.log("polling refresh...")}),this.config.delay)}}]),t}(),C=function(){function t(n){(0,i.Z)(this,t),(0,c.Z)(this,"config",void 0),(0,c.Z)(this,"container",void 0),(0,c.Z)(this,"containerWidth",void 0),(0,c.Z)(this,"columnCount",void 0),(0,c.Z)(this,"handleTimer",void 0),(0,c.Z)(this,"prevImageLength",void 0),(0,c.Z)(this,"prevLiNodesLength",void 0),(0,c.Z)(this,"divItemNodes",void 0),(0,c.Z)(this,"liNodes",void 0),this.config=n,this.container=document.querySelector(n.el),this.containerWidth=0,this.columnCount=n.columnCount||0,this.handleTimer=null,this.divItemNodes=[],this.liNodes=[],this.prevImageLength=0,this.prevLiNodesLength=0,this.init()}return(0,o.Z)(t,[{key:"init",value:function(){if(!this.container)throw"container element id:".concat(this.config.el," is not exist");var t=this.config,n=t.el,e=t.columnWidth,i=t.customStyle;this.containerWidth=this.container.offsetWidth,this.columnCount=this.columnCount||parseInt(this.containerWidth/e+""),function(t,n,e,i){var o=document.createElement("style"),r="\n      ".concat(t," {\n          display: grid;\n          grid-template-columns: repeat(").concat(n,", 1fr);\n          grid-auto-rows: 1px;\n      }\n      ").concat(t,">li {\n          width: ").concat(e,"px;\n          transform: translateY(200px);\n      }\n      ").concat(t,">li.show {\n        transform: translateY(0);\n        transition: all 0.3s;\n      }\n      ").concat(i,"\n  ");o.innerHTML=r,document.head.appendChild(o)}(n,this.columnCount,e,i)}},{key:"load",value:function(){var t=this.container.querySelectorAll("li"),n=this.container.querySelectorAll("li>div");if((null===n||void 0===n?void 0:n.length)<=0)throw"container element id:".concat(this.config.el,">li is not exist");var e=this.prevLiNodesLength-t.length;this.divItemNodes=Array.from(n).slice(e),this.liNodes=Array.from(t).slice(e),this.prevLiNodesLength=t.length,this.initLayout(),this.initPolling()}},{key:"initLayout",value:function(){for(var t=this.divItemNodes,n=this.liNodes,e=[],i=0;i<t.length;i++){var o=t[i].offsetHeight;e.push(o)}for(var r=0;r<n.length;r++){var l=n[r],a=e[r];l.style.gridRowEnd="span ".concat(parseInt(a)+this.config.rowGap),n[r].classList.contains("show")||n[r].classList.add("show")}}},{key:"loadImages",value:function(){var t,n=null===(t=this.container)||void 0===t?void 0:t.querySelectorAll("img"),e=this.prevImageLength-n.length,i=Array.from(n).slice(e);return this.prevImageLength=n.length,Z(i)}},{key:"initPolling",value:function(){var t=this;this.pollingRefresh(),this.loadImages().then((function(n){t.handleTimer&&clearInterval(t.handleTimer),t.initLayout(),setTimeout((function(){if(t.config.onChangeUlMaxH){var n=t.container.offsetHeight;t.config.onChangeUlMaxH(n)}}),20)})).catch((function(n){console.log("\u56fe\u7247\u52a0\u8f7d\u4efb\u52a1\u51fa\u9519--\x3e",n),t.handleTimer&&clearInterval(t.handleTimer)}))}},{key:"pollingRefresh",value:function(){var t=this;this.handleTimer&&clearInterval(this.handleTimer),this.handleTimer=setInterval((function(){t.initLayout(),console.log("polling refresh...")}),this.config.delay)}}]),t}();var N=e(5893);function k(t){var n=t.children,e=t.el,i=void 0===e?"#react-waterfall-comps":e,o=t.mode,r=void 0===o?"position":o,l=t.columnWidth,a=t.columnCount,s=t.columnGap,c=t.rowGap,u=t.delay,d=void 0===u?500:u,f=t.customStyle,m=void 0===f?"":f,v=t.onChangeUlMaxH,g=(0,h.useRef)();return(0,h.useEffect)((function(){g.current||(g.current=function(t){var n=Object.assign(w,t);return"position"===n.mode?new x(n):new C(n)}({mode:r,el:i,columnWidth:l,columnCount:a,columnGap:s,rowGap:c,delay:d,customStyle:m,onChangeUlMaxH:function(t){return null===v||void 0===v?void 0:v(t)}}))}),[]),(0,h.useEffect)((function(){var t,e;n.length&&(null===(t=g.current)||void 0===t||null===(e=t.load)||void 0===e||e.call(t))}),[n.length]),(0,N.jsx)("ul",{className:y()["waterfall-container"],id:i.slice(1),children:n})}function I(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)}}var R=function(t){(0,l.Z)(e,t);var n=I(e);function e(t){var o;return(0,i.Z)(this,e),o=n.call(this,t),(0,c.Z)((0,r.Z)(o),"containerRef",void 0),o.state={isReload:!0,columnWidth:0},o.containerRef=h.createRef(),o}return(0,o.Z)(e,[{key:"componentDidMount",value:function(){this.handleConfig()}},{key:"componentDidUpdate",value:function(t){var n=this;this.props.id!==t.id&&(this.handleConfig(),this.setState({isReload:!1}),setTimeout((function(){n.setState({isReload:!0})})))}},{key:"imgContent",value:function(){var t=this.props.imgList,n=this.state.columnWidth;return t.map((function(t,e){return(0,N.jsx)("li",{className:f()["waterfall-li"],children:(0,N.jsx)(u.default,{href:(0,v.XW)({id:t.id,key:m.Fh.EMOJI_DETAIL}),children:(0,N.jsx)("a",{title:t.imgTitle,children:(0,N.jsx)("div",{className:f()["waterfall-img-item"],children:(0,N.jsx)(g.Z,{width:n,preview:!1,title:t.imgTitle,src:t.imgDataOriginal,alt:t.imgDes,fallback:m.YS,loading:"lazy"},e)})})})},e)}))}},{key:"handleConfig",value:function(){var t,n=(null===(t=this.containerRef.current)||void 0===t?void 0:t.clientWidth)||1002,e=this.props,i=e.columnCount,o=(n-e.columnGap*(i-1))/i;this.setState({columnWidth:o})}},{key:"render",value:function(){var t=this.state,n=t.isReload,e=t.columnWidth,i=this.props,o=i.id,r=i.columnCount,l=i.columnGap,a=i.rowGap,s=i.minHeight;return(0,N.jsx)("div",{className:f()["waterfall-container"],ref:this.containerRef,style:{minHeight:s},children:n&&e?(0,N.jsx)(k,{el:"#waterfall".concat(o),columnWidth:e,columnCount:r,columnGap:l,rowGap:a,children:this.imgContent()}):this.imgContent()})}}]),e}(h.Component);(0,c.Z)(R,"defaultProps",{id:"waterfall-default",columnWidth:240,columnCount:4,columnGap:12,rowGap:12,minHeight:"240px"});var W=R},9330:function(t,n,e){"use strict";e.d(n,{Z:function(){return L}});var i=e(2777),o=e(2262),r=e(5959),l=e(3553),a=e(7247),s=e(7294),c=e(8731),h=e.n(c),u=e(238),d=e(9661),f=e(5274),m=e(1889),v=e(5893);function g(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)}}var p=function(t){(0,r.Z)(e,t);var n=g(e);function e(t){var o;return(0,i.Z)(this,e),(o=n.call(this,t)).state={keywordList:u.kp},o}return(0,o.Z)(e,[{key:"render",value:function(){var t=this.state.keywordList;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(f.Z,{className:h().container,title:"\u70ed\u641c\u699c",children:(0,v.jsx)("div",{className:h()["keyword-container"],children:t.map((function(t,n){return(0,v.jsx)(m.Z,{className:h().keyword,href:(0,d.XW)({key:u.Fh.SEARCH_KEYWORD,query:{keyword:t}}),children:t},n)}))})})})}}]),e}(s.Component);function y(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)}}var L=function(t){(0,r.Z)(e,t);var n=y(e);function e(t){return(0,i.Z)(this,e),n.call(this,t)}return(0,o.Z)(e,[{key:"render",value:function(){var t=this.props.children;return(0,v.jsx)("main",{className:"main-container",children:(0,v.jsxs)("div",{className:"main-content",children:[t,(0,v.jsx)("div",{className:"right-content",children:(0,v.jsx)(p,{})})]})})}}]),e}(s.Component)},8731:function(t){t.exports={container:"HotSearch_container__LqqEh","keyword-container":"HotSearch_keyword-container__L_yBr",keyword:"HotSearch_keyword__Gnagq"}},8280:function(t){t.exports={"waterfall-container":"Waterfall_waterfall-container__ZYPmB"}},9239:function(t){t.exports={"waterfall-container":"ImgWaterfall_waterfall-container__AXqxG","waterfall-li":"ImgWaterfall_waterfall-li__NEHey","waterfall-img-item":"ImgWaterfall_waterfall-img-item__v0bFH"}}}]);